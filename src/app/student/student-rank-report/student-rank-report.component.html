<app-student-navigation></app-student-navigation>
<mat-label>Upload Student Marks</mat-label>
<p><mat-label style="color: green;">{{message}}</mat-label></p>
<label class="form-label" style="color: red;">{{errormessage}}</label>
<form>
    <div style="width: 100%">

        <mat-form-field style="padding-right: 2px;width:135px">
            <mat-label>Test Type</mat-label>
            <mat-select [(ngModel)]="selectedTestType" name="testtype" (selectionChange)="changeTestType($event)">
                @for (testtype of testtypes; track testtype) {
                <mat-option [value]="testtype.id">{{testtype.testTypeName}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
        <mat-form-field style="padding-right: 2px;width:115px">
            <mat-label>Division</mat-label>
            <mat-select [(ngModel)]="selectedDivision" name="division" (selectionChange)="changeDivision($event)">
                @for (division of divisions; track division) {
                <mat-option [value]="division.id">{{division.divisionName}}</mat-option>
                }
            </mat-select>
        </mat-form-field>

        <mat-form-field style="padding-right: 2px;width:125px">
            <mat-label>Standard</mat-label>
            <mat-select [(ngModel)]="selectedStandard" name="standard" (selectionChange)="changeStandard($event)">
                @for (standard of standards; track standard) {
                <mat-option [value]="standard.id">{{standard.standardName}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
        <mat-form-field style="padding-right: 2px;width:115px">
            <mat-label>Year</mat-label>
            <mat-select [(ngModel)]="selectedYear" name="year" (selectionChange)="changeYear($event)">
                @for (year of years; track year) {
                <mat-option [value]="year.id">{{year.year}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
        <mat-form-field style="padding-right: 2px;width:115px">
            <mat-label>Month</mat-label>
            <mat-select [(ngModel)]="selectedMonth" name="month" (selectionChange)="changeMonth($event)">
                @for (month of months; track month) {
                <mat-option [value]="month.id">{{month.monthName}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
        <mat-form-field style="padding-right: 2px;width:115px">
            <mat-label>TestHeldOfMark</mat-label>
            <mat-select [(ngModel)]="selectedTestHeldOfMark" name="testheldofmark"
                (selectionChange)="changeTestHeldOfMark($event)">
                @for (testheldofmark of testheldofmarks; track testheldofmark) {
                <mat-option [value]="testheldofmark.id">{{testheldofmark.outOfMark}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
        <mat-form-field style="padding-right: 2px;width:155px">
            <mat-label>Stream Type</mat-label>
            <mat-select [(ngModel)]="selectedStreamType" name="streamtype" (selectionChange)="changeStreamType($event)">
                @for (streamtype of streamtypes; track streamtype) {
                <mat-option [value]="streamtype.id" [id]="streamtype.streamName">{{streamtype.streamName}}</mat-option>
                }
            </mat-select>
        </mat-form-field>
    </div>
    <div class="example-button-row" style="float:left;">
        <button (click)="fetchData()" mat-flat-button>View Rank Report</button>
        <button (click)="onBtExport()" mat-flat-button>Export Data</button>
    </div>
    <div style="clear:both;"></div>
    <div *ngIf="StudentTopThreeRankList">
        <ag-grid-angular [rowData]="StudentTopThreeRankList" [columnDefs]="colDefs" style="height: 250px;width:auto;"
            (gridReady)="onGridReady($event)" />
    </div>
    <div *ngIf="StudentTopSubjectRankList">
        <ag-grid-angular [rowData]="StudentTopSubjectRankList" [columnDefs]="colSubjectDefs"
            style="height: 400px;width:auto;" (gridReady)="onGridReady($event)" />
    </div>
</form>